#!/usr/bin/env node

const { spawn } = require('child_process');

const certDir = __dirname + '/cert';
const certFile =  certDir + '/https-server.crt';
const keyFile = certDir + '/https-server.key';

const argv = process.argv.slice(2);

// Enable HTTPs
if (!argv.includes('-S') && !argv.includes('--ssl')) {
    argv.push('-S');
}

// Add SSL cert file
if (!argv.includes('-C') && !argv.includes('--cert')) {
    argv.push('-C', certFile);
}

// Add SSL key file
if (!argv.includes('-K') && !argv.includes('--key')) {
    argv.push('-K', keyFile);
}

// Pipes child process stdio to this process stdio
const stdio = [ process.stdin, process.stdout, process.stdout ];

spawn('http-server', argv, { stdio });
